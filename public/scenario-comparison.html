<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Umfassender Szenario-Vergleich - ETF-Sparplan Rechner</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="css/main.css">
    <script type="module" src="js/features/scenarioComparison.js"></script>
</head>
<body class="scenario-comparison">
    <div class="container">
        <div class="header">
            <h1>ğŸ” Umfassender Szenario-Vergleich</h1>
            <p>Vergleichen Sie verschiedene Finanzplanungsszenarien und analysieren Sie deren Auswirkungen</p>
        </div>

        <div class="main-content">
            <div class="scenario-comparison-section" id="scenarioComparisonSection">
                <div class="comparison-top-controls">
                    <div class="scenario-chooser">
                        <button class="btn-scenario" data-scenario="optimistic">ğŸ¯ Optimistisch</button>
                        <button class="btn-scenario active" data-scenario="conservative">ğŸ›¡ï¸ Konservativ</button>
                        <button class="btn-scenario btn-new">+ Neues Szenario</button>
                    </div>
                    <div class="action-buttons">
                        <button class="comparison-btn btn-load">ğŸ“‹ Vorlage laden</button>
                        <button class="comparison-btn btn-save">ğŸ’¾ Konfiguration speichern</button>
                        <button class="comparison-btn btn-export">ğŸ“Š Export</button>
                    </div>
                </div>

                <!-- Layout -->
                <div class="comparison-layout scenario-conservative" id="comparisonLayout">
                    <!-- Left: Parameters -->
                    <div class="comparison-params-panel">
                        <div class="phase-pills" id="comparisonPhasePills">
                            <button class="pill active" data-target="budget">Budget</button>
                            <button class="pill" data-target="accumulation">Ansparphase</button>
                            <button class="pill" data-target="withdrawal">Entnahmephase</button>
                        </div>

                        <!-- Budget Section -->
                        <div class="param-section" id="comparisonBudgetSection">
                            <div class="param-header" data-toggle="budgetGrid">
                                <h4>ğŸ’¼ Budgetplanung</h4>
                                <div class="header-actions">
                                    <button class="btn-import" id="budgetImportBtn">Importieren â–¼</button>
                                    <button class="toggle-btn" type="button">
                                        <span class="toggle-icon">â–²</span>
                                    </button>
                                </div>
                            </div>
                            <div class="param-grid active" id="budgetGrid">
                                <!-- Read-only budget display after import -->
                                <div id="budgetReadonly" style="width: 100%;">
                                    <div class="kv-container">
                                        <div class="kv" data-title="Budget">
                                            <span class="k">Gesamteinkommen</span><span class="v" id="budgetIncome">â€”</span>
                                            <span class="k">Gesamtausgaben</span><span class="v" id="budgetExpenses">â€”</span>
                                            <span class="k">Sparrate</span><span class="v" id="budgetSavings">â€”</span>
                                            <span class="k">VerfÃ¼gbar</span><span class="v" id="budgetAvailable">â€”</span>
                                        </div>
                                        <div class="kv" data-title="Annahmen">
                                            <span class="k">Inflation p.a.</span><span class="v" id="budgetInflation">â€”</span>
                                            <span class="k">Perioden</span><span class="v" id="budgetPeriods">â€”</span>
                                            <span class="k">Profil</span><span class="v" id="budgetProfileName">â€”</span>
                                            <span class="k"></span><span class="v"></span>
                                        </div>
                                    </div>
                                    <div id="budgetImportMenu" style="display:none; margin-top:12px; border:1px solid #e5e7eb; border-radius:8px; padding:10px; background:#fff;">
                                        <strong style="display:block; margin-bottom:8px; color:#2c3e50;">Profil wÃ¤hlen</strong>
                                        <div id="budgetImportList" style="display:grid; gap:8px;"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Accumulation Section -->
                        <div class="param-section" id="comparisonAccumSection">
                            <div class="param-header" data-toggle="accumGrid">
                                <h4>ğŸ“ˆ Ansparphase</h4>
                                <div class="header-actions">
                                    <button class="btn-import">Importieren â–¼</button>
                                    <button class="toggle-btn" type="button">
                                        <span class="toggle-icon">â–¼</span>
                                    </button>
                                </div>
                            </div>
                            <div class="param-grid" id="accumGrid">
                                <div class="field">
                                    <label for="accReturn">Rendite p.a. (%)</label>
                                    <input id="accReturn" class="input-field" type="number" placeholder="8.5" step="0.1" />
                                </div>
                                <div class="field">
                                    <label for="accYears">Dauer (Jahre)</label>
                                    <input id="accYears" class="input-field" type="number" placeholder="30" step="1" />
                                </div>
                                <div class="field">
                                    <label for="accInitial">Einmalanlage (â‚¬)</label>
                                    <input id="accInitial" class="input-field" type="number" placeholder="10000" step="100" />
                                </div>
                                <div class="field">
                                    <label for="accMonthly">Monatliche Sparrate (â‚¬)</label>
                                    <input id="accMonthly" class="input-field" type="number" placeholder="1000" step="10" />
                                </div>
                            </div>
                        </div>

                        <!-- Withdrawal Section -->
                        <div class="param-section" id="comparisonWithdrawSection">
                            <div class="param-header" data-toggle="withdrawGrid">
                                <h4>ğŸ–ï¸ Entnahmephase</h4>
                                <div class="header-actions">
                                    <button class="btn-import">Importieren â–¼</button>
                                    <button class="toggle-btn" type="button">
                                        <span class="toggle-icon">â–¼</span>
                                    </button>
                                </div>
                            </div>
                            <div class="param-grid" id="withdrawGrid">
                                <div class="field">
                                    <label for="wdRate">Entnahmerate (%)</label>
                                    <input id="wdRate" class="input-field" type="number" placeholder="4" step="0.1" />
                                </div>
                                <div class="field">
                                    <label for="wdYears">Dauer (Jahre)</label>
                                    <input id="wdYears" class="input-field" type="number" placeholder="30" step="1" />
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Right: Results -->
                    <div class="comparison-results-panel">
                        <!-- Scenario summary cards -->
                        <h3>ğŸ† Szenario-Ãœbersicht</h3>
                        <div class="summary-cards">
                            <div class="summary-card primary">
                                <h4>ğŸ¯ Optimistisch</h4>
                                <div class="kv-container">
                                    <div class="kv">
                                        <span class="k">EndvermÃ¶gen</span><span class="v" id="sum-final-optimistic">â€”</span>
                                        <span class="k">Ã˜ Rendite</span><span class="v" id="sum-return-optimistic">â€”</span>
                                        <span class="k">Sparrate (â‚¬)</span><span class="v" id="sum-monthly-optimistic">â€”</span>
                                        <span class="k">Entnahmerate</span><span class="v" id="sum-wdrate-optimistic">â€”</span>
                                    </div>
                                    <div class="kv">
                                        <span class="k">Ansparphase (in Jahre)</span><span class="v" id="sum-accyears-optimistic">â€”</span>
                                        <span class="k">Entnahmedauer (in Jahre)</span><span class="v" id="sum-wdyears-optimistic">â€”</span>
                                        <span class="k">Risikoprofil</span><span class="v">Hoch</span>
                                    </div>
                                </div>
                            </div>
                            <div class="summary-card success">
                                <h4>ğŸ›¡ï¸ Konservativ</h4>
                                <div class="kv-container">
                                    <div class="kv">
                                        <span class="k">EndvermÃ¶gen</span><span class="v" id="sum-final-conservative">â€”</span>
                                        <span class="k">Ã˜ Rendite</span><span class="v" id="sum-return-conservative">â€”</span>
                                        <span class="k">Sparrate (â‚¬)</span><span class="v" id="sum-monthly-conservative">â€”</span>
                                        <span class="k">Entnahmerate</span><span class="v" id="sum-wdrate-conservative">â€”</span>
                                    </div>
                                    <div class="kv">
                                        <span class="k">Ansparphase (in Jahre)</span><span class="v" id="sum-accyears-conservative">â€”</span>
                                        <span class="k">Entnahmedauer (in Jahre)</span><span class="v" id="sum-wdyears-conservative">â€”</span>
                                        <span class="k">Risikoprofil</span><span class="v">Niedrig</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Chart Controls -->
                        <div class="chart-controls-bar">
                            <div class="view-pills" id="comparisonChartViews">
                                <button class="chart-view-btn active" data-view="lifecycle">ğŸ”„ Lebenszyklus</button>
                                <button class="chart-view-btn" data-view="accumulation">ğŸ“ˆ Ansparphase</button>
                                <button class="chart-view-btn" data-view="withdrawal">ğŸ–ï¸ Entnahmephase</button>
                                <button class="chart-view-btn" data-view="metrics">ğŸ¯ Kennzahlen Radar</button>
                            </div>
                            <div class="scenario-visibility">
                                <label><input type="checkbox" checked />ğŸ¯ Optimistisch</label>
                                <label><input type="checkbox" checked />ğŸ›¡ï¸ Konservativ</label>
                            </div>
                        </div>

                        <!-- Charts -->
                        <div class="comparison-chart-view active" id="comparisonLifecycleView">
                            <canvas id="comparisonLifecycleChart"></canvas>
                        </div>
                        <div class="comparison-chart-view" id="comparisonAccumulationView">
                            <canvas id="comparisonAccumulationChart"></canvas>
                        </div>
                        <div class="comparison-chart-view" id="comparisonWithdrawalView">
                            <canvas id="comparisonWithdrawalChart"></canvas>
                        </div>
                        <div class="comparison-chart-view" id="comparisonMetricsView">
                            <canvas id="comparisonMetricsChart"></canvas>
                        </div>

                        <!-- Parameter Comparison Table -->
                        <div class="comparison-table-wrapper">
                            <div class="table-filters" id="comparisonTableFilters">
                                <button class="filter-btn active" data-category="all">Alle</button>
                                <button class="filter-btn" data-category="budget">Budget</button>
                                <button class="filter-btn" data-category="accumulation">Ansparphase</button>
                                <button class="filter-btn" data-category="withdrawal">Entnahmephase</button>
                                <button class="filter-btn" data-category="results">Ergebnisse</button>
                            </div>
                            <div class="table-content">
                                <table id="comparisonTable">
                                    <thead>
                                        <tr>
                                            <th>Parameter</th>
                                            <th>ğŸ¯ Optimistisch</th>
                                            <th>ğŸ›¡ï¸ Konservativ</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <!-- Budget Group -->
                                        <tr class="group-header" data-category-group="budget">
                                            <th colspan="3">Budget</th>
                                        </tr>
                                        <tr data-category="budget">
                                            <td>Einkommen (â‚¬/Monat)</td>
                                            <td>4000</td>
                                            <td>3500</td>
                                        </tr>
                                        <tr data-category="budget">
                                            <td>Ausgaben (â‚¬/Monat)</td>
                                            <td>3000</td>
                                            <td>2800</td>
                                        </tr>
                                        <tr data-category="budget">
                                            <td>Sparrate (â‚¬)</td>
                                            <td>1.000</td>
                                            <td>500</td>
                                        </tr>
                                        <tr data-category="budget">
                                            <td>Inflation p.a. (%)</td>
                                            <td>2.2%</td>
                                            <td>2.2%</td>
                                        </tr>
                                        
                                        <!-- Accumulation Group -->
                                        <tr class="group-header" data-category-group="accumulation">
                                            <th colspan="3">Ansparphase</th>
                                        </tr>
                                        <tr data-category="accumulation">
                                            <td>Rendite p.a. (%)</td>
                                            <td>8.5%</td>
                                            <td>5.5%</td>
                                        </tr>
                                        <tr data-category="accumulation">
                                            <td>Dauer (Jahre)</td>
                                            <td>30</td>
                                            <td>25</td>
                                        </tr>
                                        <tr data-category="accumulation">
                                            <td>Monatl. Sparrate (â‚¬)</td>
                                            <td>1,000</td>
                                            <td>500</td>
                                        </tr>
                                        
                                        <!-- Withdrawal Group -->
                                        <tr class="group-header" data-category-group="withdrawal">
                                            <th colspan="3">Entnahmephase</th>
                                        </tr>
                                        <tr data-category="withdrawal">
                                            <td>Entnahmerate (%)</td>
                                            <td>4%</td>
                                            <td>3%</td>
                                        </tr>
                                        <tr data-category="withdrawal">
                                            <td>Dauer (Jahre)</td>
                                            <td>25</td>
                                            <td>30</td>
                                        </tr>

                                        <!-- Results Group -->
                                        <tr class="group-header" data-category-group="results">
                                            <th colspan="3">Ergebnisse</th>
                                        </tr>
                                        <tr data-category="results">
                                            <td>EndvermÃ¶gen</td>
                                            <td>1.2 Mio â‚¬</td>
                                            <td>800k â‚¬</td>
                                        </tr>
                                        
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Full Summary -->
                <div class="comparison-full-summary">
                    <h3>ğŸ“Œ Zusammenfassung & Empfehlungen</h3>
                    <p>Das optimistische Szenario maximiert das erwartete EndvermÃ¶gen bei hÃ¶herer VolatilitÃ¤t und Drawdown-Risiko; das konservative priorisiert StabilitÃ¤t und eine hÃ¶here Erfolgswahrscheinlichkeit in langen Entnahmephasen. Eine ausgewogene Allokation mit situativem Rebalancing, moderater Entnahmerate (3.5â€“4%) und inflationsadjustierter Planung liefert robuste Ergebnisse Ã¼ber verschiedene Marktregime.</p>
                </div>
            </div>
        </div>
        
        <!-- Disclaimer Footer -->
        <div class="disclaimer-footer">
            <div class="kleingedrucktes">
                <strong>Haftungsausschluss:</strong> Diese Anwendung dient ausschlieÃŸlich zu Informationszwecken und stellt keine Anlageberatung dar. 
                Alle Berechnungen basieren auf historischen Daten und Annahmen, die sich Ã¤ndern kÃ¶nnen. Vergangene Wertentwicklungen sind 
                kein verlÃ¤sslicher Indikator fÃ¼r zukÃ¼nftige Ergebnisse. <strong>Bitte konsultieren Sie einen Finanzberater</strong>, 
                bevor Sie Anlageentscheidungen treffen. Der Entwickler Ã¼bernimmt keine Haftung fÃ¼r Verluste, die durch die Nutzung 
                dieser Anwendung entstehen kÃ¶nnten.
            </div>
        </div>
    </div>
</body>
</html>
